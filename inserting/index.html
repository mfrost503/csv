<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="icon" type="image/x-icon" href="/themes/thephpleague/thephpleague.github.com/img/favicon.ico" />
                <link rel="apple-touch-icon-precomposed" href="/themes/thephpleague/thephpleague.github.com/img/apple-touch-icon-precomposed.png">
                <title>Reading &amp; Filtering - CSV</title>
                <meta name="description" content="Working with CSV can often be much more difficult than you expect, with different types of delimiter and complicated structures. This makes it easy to read and write almost anything.">
                <link rel="stylesheet" href="/themes/thephpleague/thephpleague.github.com/css/all.css">
    </head>
<body>

<section class="all_packages">
    <a href="http://thephpleague.com/">
        <img src="/themes/thephpleague/thephpleague.github.com/img/loep_logo.png" width="195" height="200" alt="The League of Extraordinary Packages">
    </a>
    <h2>Our Packages:</h2>
    <ul>
    </ul>
</section>

<header>
    <a class="logo" href="/">
                <span class="name">CSV</span>
        <span class="tagline">CSV data manipulation made easy in PHP.</span>
    </a>
    <a href="http://thephpleague.com/" class="league">
        Presented by The League of Extraordinary Packages
    </a>
</header>

<input type="checkbox" id="menu">
<label for="menu" onclick>
    <div class="closed">&#9776; Menu</div>
    <div class="open">&#9776; Hide Menu</div>
</label>

<main>
    <menu>
                    <h2>Getting Started</h2>
            <ul>
                                    <li >
                        <a href="/">Introduction</a>
                    </li>
                                    <li >
                        <a href="/examples/">Examples</a>
                    </li>
                                    <li >
                        <a href="/installation/">Installation</a>
                    </li>
                            </ul>
                    <h2>The API</h2>
            <ul>
                                    <li >
                        <a href="/overview/">Overview</a>
                    </li>
                                    <li >
                        <a href="/outputting/">Outputting</a>
                    </li>
                                    <li >
                        <a href="/reading/">Extracting</a>
                    </li>
                                    <li class="selected">
                        <a href="/inserting/">Inserting</a>
                    </li>
                                    <li >
                        <a href="/filtering/">Filtering</a>
                    </li>
                            </ul>
                    <h2>Upgrading Guide</h2>
            <ul>
                                    <li >
                        <a href="/upgrading/">Introduction</a>
                    </li>
                                    <li >
                        <a href="/upgrading/6.0/">5.x to 6.x</a>
                    </li>
                            </ul>
            </menu>
    <article>
        <h1>Inserting Data</h1>

<p>To create or update a CSV use the following <code>League\Csv\Writer</code> methods.</p>

<p class="message-warning">When inserting strings don't forget to specify the CSV delimiter and enclosure characters that match those use in the string.</p>

<p class="message-info">When creating a file using the library, first insert all the data that need to be inserted before starting manipulating the CSV. If you manipulate your data before insertion, you may change the file cursor position and get unexpected results.</p>

<h2>Adding data to a CSV</h2>

<h3>insertOne($data)</h3>

<p><code>insertOne</code> inserts a single row. This method can take an <code>array</code>, a <code>string</code> or
an <code>object</code> implementing the <code>__toString</code> method.</p>

<pre><code class="language-php">class ToStringEnabledClass
{
    private $str;

    public function __construct($str)
    {
        $this-&gt;str = $str;
    }

    public function __toString()
    {
        return $this-&gt;str;
    }
}

$writer-&gt;insertOne(['john', 'doe', 'john.doe@example.com']);
$writer-&gt;insertOne("'john','doe','john.doe@example.com'"); 
$writer-&gt;insertOne(new ToStringEnabledClass("john,doe,john.doe@example.com")) 
</code></pre>

<h3>insertAll($data)</h3>

<p><code>insertAll</code> inserts multiple rows. This method can take an <code>array</code> or a 
<code>Traversable</code> object to add several rows to the CSV data.</p>

<pre><code class="language-php">$arr = [
    [1, 2, 3],
    ['foo', 'bar', 'baz'],
    "'john','doe','john.doe@example.com'",
    new ToStringEnabledClass("john,doe,john.doe@example.com")
];

$writer-&gt;insertAll($arr); //using an array 

$object = new ArrayIterator($arr);
$writer-&gt;insertAll($object); //using a Traversable object
</code></pre>

<h2>Handling null values (since version 5.3)</h2>

<p>When importing data containing <code>null</code> values you should tell the library how to handle them.</p>

<h3>setNullHandlingMode($mode)</h3>

<p>To set the <code>Writer</code> class handling behavior, you will use the <code>setNullHandlingMode</code> method. This method takes one of these constants mode:</p>

<ul>
<li><code>Writer::NULL_AS_EXCEPTION</code>: Inserting methods throw an <code>InvalidArgumentException</code> when a <code>null</code> value is found;</li>
<li><code>Writer::NULL_AS_EMPTY</code>:Inserting methods convert <code>null</code> values into empty string;</li>
<li><code>Writer::NULL_AS_SKIP_CELL</code>: Inserting methods filter out each <code>null</code> item found;</li>
</ul>

<p class="message-warning">By default the Writer mode to handle <code>null</code> value is <code>Writer::NULL_AS_EXCEPTION</code> to keep the code backward compatible.</p>

<pre><code class="language-php">$writer-&gt;setNullHandlingMode(Writer::NULL_AS_SKIP_CELL);
$writer-&gt;insertOne(["one", "two", null, "four"]); 
</code></pre>

<p>In the above example, the <code>null</code> value will be filter out and the corresponding CSV row will contain only 3 items.</p>

<h3>getNullHandlingMode()</h3>

<p>At any given time you are able to know the class mode using the <code>getNullHandlingMode</code> method.</p>

<pre><code class="language-php">if (Writer::NULL_AS_EXCEPTION == $writer-&gt;getNullHandlingMode()) {
    $writer-&gt;setNullHandlingMode(Writer::NULL_AS_EMPTY);
}
$writer-&gt;insertOne(["one", "two", null, "four"]); 
</code></pre>

<p>In the above example, the <code>null</code> value will be converted into an empty string, only if the current mode handles the value by throwing exception.</p>

<h2>Handling CSV columns count consistency (since version 5.4)</h2>

<p>You can optionally asks the Writer class to check the columns count consistency of the newly added rows in you CSV. To do so you need to set the class <code>$columns_count</code> property.</p>

<h3>getColumnsCount()</h3>

<p>At any given time you can access the <code>$columns_count</code> property using the <code>getColumnsCount</code> method.</p>

<p class="message-warning">By default and for backward compatibility, the <code>$columns_count</code>property equals <code>-1</code> which means that column count consistency is not checked.</p>

<h3>setColumnsCount($value)</h3>

<p>One way to do enable the columns count check is to use the <code>setColumnsCount</code> method to set the property to an integer greater than <code>-1</code>.</p>

<pre><code class="language-php">$writer-&gt;setColumnsCount(2);
$nb_column_count = $writer-&gt;getColumnsCount(); // equals to 2;
$writer-&gt;insertAll([
    ["one", "two"],
    ["one", "two", "four"],  //this will throw an InvalidArgumentException
]); 
</code></pre>

<h3>autodetectColumnsCount()</h3>

<p>Another way is to use the <code>autodetectColumnsCount</code> method which will set the <code>$columns_count</code> property according to the next inserted row.</p>

<pre><code class="language-php">use League\Csv\Writer;

$writer = Writer::createFromPath('path/to/csv', 'w');
$writer-&gt;autodetectColumnsCount();
$nb_column_count = $writer-&gt;getColumnsCount(); // equals to -1 = default value;
$writer-&gt;insertOne(["one", "two", "four"]); 
$nb_column_count = $writer-&gt;getColumnsCount(); // equals to 3;
$writer-&gt;insertOne(["one", "two"]); //this will throw an InvalidArgumentException
</code></pre>

<p>Keep in mind that:</p>

<ul>
<li>the effect of the <code>autodetectColumnsCount</code> method will only take place after the next call to <code>insertOne</code>.</li>
<li><code>setColumnsCount</code> and <code>autodetectColumnsCount</code> override each other effect when called before <code>insertOne</code>;</li>
</ul>
    </article>
</main>

<footer>
    <span>&copy; Copyright The League of Extraordinary Packages.</span>
    <span>Site design by <a href="http://reinink.ca">Jonathan Reinink</a>.</span>
    <span>Powered by <a href="https://sculpin.io">Sculpin</a>.</span>
</footer>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="/themes/thephpleague/thephpleague.github.com/js/scripts.js"></script>
<script src="/themes/thephpleague/thephpleague.github.com/js/prism.js"></script>

    <script>
        (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
        function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
        e=o.createElement(i);r=o.getElementsByTagName(i)[0];
        e.src='//www.google-analytics.com/analytics.js';
        r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
        ga('create','UA-46050814-6');ga('send','pageview');
    </script>

</body>
</html>